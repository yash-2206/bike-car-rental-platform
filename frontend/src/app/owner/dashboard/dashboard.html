<div class="dashboard-container">

  <!-- Earnings Cards -->
  <div class="earnings-grid">
    <mat-card class="earning-card primary-gradient">
      <mat-card-header>
        <mat-icon>payments</mat-icon>
        <mat-card-title>Total Earnings</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <h2>₹{{ earnings.total_earnings }}</h2>
      </mat-card-content>
    </mat-card>

    <mat-card class="earning-card success-gradient">
      <mat-card-header>
        <mat-icon>event_available</mat-icon>
        <mat-card-title>Total Bookings</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <h2>{{ earnings.total_bookings }}</h2>
      </mat-card-content>
    </mat-card>
  </div>

<!-- Vehicles -->
  <mat-card class="section-card">
    <mat-card-header>
      <mat-icon>directions_car</mat-icon>
      <mat-card-title>Your Vehicles</mat-card-title>
      <span class="spacer"></span>
      <button mat-raised-button color="primary" routerLink="/owner/vehicles/new">
        <mat-icon>add</mat-icon> Add Vehicle
      </button>
    </mat-card-header>
  
    <mat-divider></mat-divider>
  
    <mat-card-content>
      <div class="vehicle-scroll" *ngIf="vehicles.length; else noVehicles">
        <div class="vehicle-card margin-1 border-0" *ngFor="let v of vehicles">
          <div class="card h-100 shadow-sm">
            <!-- Vehicle Image -->
            <img class="card-img-top"
              [src]="v?.images?.[0]?.image_url || 'https://cdn.pixabay.com/photo/2012/05/29/00/43/car-49278_1280.jpg'"
              [alt]="(v?.brand || '') + ' ' + (v?.model || '')" style="height: 180px; object-fit: cover;"
              (error)="onImageError($event)">

  
            <!-- Vehicle Details -->
            <div class="card-body">
              <h5 class="card-title">{{ v.brand }} {{ v.model }}</h5>
              <p class="card-text mb-1"><strong>Location:</strong> {{ v.location }}</p>
              <p class="card-text mb-1 text-success fw-bold">₹{{ v.price_per_day }}/day</p>
              <p class="card-text text-muted mb-0">Hourly: ₹{{ v.hourly_rate }}</p>
            </div>
  
            <!-- Action Buttons -->
            <div class="card-footer d-flex justify-content-between bg-white border-0 padding-2">
              <button mat-stroked-button  color="accent" [routerLink]="['/vehicles', v.id]">
                <mat-icon>visibility</mat-icon> View
              </button>
              <button mat-stroked-button color="primary" (click)="deleteVehicle(v.id)">
                <mat-icon>delete</mat-icon> Delete
              </button>
            </div>
          </div>
        </div>
      </div>
  
      <ng-template #noVehicles>
        <p class="empty-text text-center mt-3">
          <mat-icon>info</mat-icon> No vehicles registered yet.
        </p>
      </ng-template>
    </mat-card-content>
  </mat-card>

<!-- Bookings -->
<mat-card class="section-card">
  <mat-card-header>
    <mat-icon>book_online</mat-icon>
    <mat-card-title>Your Bookings</mat-card-title>
  </mat-card-header>
  <mat-divider></mat-divider>
  <mat-card-content>
    <div *ngIf="bookings.length; else noBookings" class="row row-cols-1 row-cols-md-2 g-3 mt-2">
      <div class="col" *ngFor="let b of bookings">
        <div class="card shadow-sm h-100">
          <div class="card-body">
            <h5 class="card-title mb-1">
              {{ b.vehicle?.brand }} {{ b.vehicle?.model }}
            </h5>
            <div class="text-muted mb-2">
              {{ b.start_date | date:'mediumDate' }} → {{ b.end_date | date:'mediumDate' }}
            </div>

            <div class="d-flex align-items-center gap-2">
              <span class="badge bg-primary" *ngIf="b.total_cost">₹{{ b.total_cost }}</span>
              <span class="badge" [ngClass]="{
                      'bg-warning text-dark': b.status === 'pending',
                      'bg-info': b.status === 'confirmed',
                      'bg-success': b.status === 'completed'
                    }">
                {{ b.status || 'pending' }}
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <ng-template #noBookings>
      <p class="empty-text"><mat-icon>calendar_today</mat-icon> No bookings yet.</p>
    </ng-template>
  </mat-card-content>
</mat-card>


</div>